<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>
            Export Report
        </title>
    </head>

    <body bgcolor="#ffffff">

        <h1><u>Export Report</u></h1>
        Report Export module that allows users to customize content and export in a desired format.
        <ul>
            <li>Created by <a href="https://github.com/JordanGS">JordanGS</a>.</li>
            <li>Minimum Supported Version: Weekly Release ZAP_D-2016-09-05</li>
            <li>Project on  <a href="https://github.com/JordanGS/workspace">GitHub</a>. You can also find a .zip of the minimum supported release in the zap-download folder.</li>
            <li>Supported and incorporated in the <a href="https://wiki.jenkins-ci.org/display/JENKINS/zap+plugin">Official OWASP Zed Attack Proxy Jenkins Plugin</a>.</li>
        </ul>

        <h2><u>Table of Contents</u></h2>
        <ul>
            <li>ZAP UI</li>
            <li>Command Line</li>
            <li>API Calls</li>
        </ul>

        <hr>

        <a name="zap-ui"></a> 
        <h2><u>ZAP UI</u></h2>

        <h4>Source Info</h4>
        User entered and automatically retrieve data relevant to the report. Hover over each field in the extension for tool tip.
        <ul>
            <li>Title - Defaults to Session Name</li>
            <li>By</li>
            <li>For</li>
            <li>Scan Date - User entered date of AScan, defaults to current date-time</li>
            <li>Report Date - Defaults to current date-time</li>
            <li>Scan Version - Placeholder for future</li>
            <li>Report Version - Defaults to current version of ZAP tool</li>
        </ul>
        <h4>UI</h4>
        <ul style="list-style-type:none">
            <li>
                <img src="images/SourceInfo.png" alt="Source Info">
            </li>
        </ul>
        <br>

        <h4>Alert Severity</h4>
        Include/Exclude Alerts by Severity.
        <h4>Included by Default</h4>
        <ul>
            <li>High</li>
            <li>Medium</li>
            <li>Low</li>
            <li>Informational</li>
        </ul>
        <h4>UI</h4>
        <ul style="list-style-type:none">
            <li>
                <img src="images/AlertSeverity.png" alt="Source Info">
            </li>
        </ul>
        <br>

        <h4>Alert Details</h4>
        Include/Exclude Details of each Alert.
        <h4>Included by Default</h4>
        <ul>
            <li>CWE ID</li>
            <li>WASC ID</li>
            <li>Description</li>
            <li>Other Info</li>
            <li>Solution</li>
            <li>Reference</li>
        </ul>

        <h4>Excluded by Default</h4>
        <ul>
            <li>Request Header</li>
            <li>Response Header</li>
            <li>Request Body</li>
            <li>Response Body</li>
        </ul>

        <h4>UI</h4>

        <ul style="list-style-type:none">
            <li>
                <img src="images/Alert Details.png" alt="Source Info">
            </li>
        </ul>

        <hr>

        <h4>File Chooser Dialog</h4>
        The dialog only shows folders and accepted file types. The 'Files of Type' drop down list will filter to show only folders and files of the specified extension.

        <h4>Currently Available</h4>
        <ul>
            <li>ASCII 1.0 Strict Compliant XHTML Files (.xhtml <img src="../../images/html.png" alt="XHTML Icon">)</li>
            <li>XML Files (.xml <img src="../../images/xml.png" alt="XML Icon">)</li>
            <li>JSON Files (.json <img src="../../images/json.png" alt="JSON Icon">)</li>
        </ul>

        <h4>Future Milestone</h4>
        <ul>
            <li>Bootstrap HTML Files(.bootstrap.html <img src="../../images/bootstrap.png" alt="BOOTSTRAP Icon">)</li>
            <li>PDF Documents (.pdf <img src="../../images/pdf.png" alt="PDF Icon">)</li>
            <li>Google Documents (.doc <img src="../../images/doc.png" alt="DOC Icon">)</li>
        </ul>            

        <h4>UI</h4>
        <ul style="list-style-type:none">
            <li>
                Show all accepted files
            </li>
            <li>
                <img src="images/FileChooser.png" alt="Source Info">
            </li>
            <li><br></li>
            <li>
                List of accepted file formats
            </li>
            <li>
                <img src="images/FileChooserChoices.png" alt="Source Info">
            </li>
            <li><br></li>
            <li>
                Filter by a specific file format
            </li>
            <li>
                <img src="images/FileChooserFilter.png" alt="Source Info">
            </li>
        </ul>

        <hr>

        <a name="command-line"></a> 
        <h2><u>Command Line</u></h2>
        The extension can be run from the command line as well and requires the following arguments to be passed in to generate a report.

        <h4>OWASP ZAP Command Line Options</h4>
        <ul style="list-style: none;">
            <li><b>-session</b>: Opens the given session after starting ZAP</li>
            <li><b>-cmd</b>: Runs ZAP 'inline', ie without starting the UI or a daemon</li>
        </ul>
        See the <a href="https://github.com/zaproxy/zap-core-help/wiki/HelpCmdline">Wiki</a> for more details on the natively supported command line options.

        <h4>Export Report Extension Command Line Options</h4>
        <ul style="list-style: none;">
            <li><hr></li>
            <li><b>-export_report</b>: 
                <ul style="list-style: none;">
                    <li>
                        <h4>Description:</h4>
                        <ul>
                            <li>Saves to the specified file after loading the given session.</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Currently Available</h4>
                        <ul>
                            <li>ASCII 1.0 Strict Compliant XHTML Files (.xhtml <img src="../../images/html.png" alt="XHTML Icon">)</li>
                            <li>XML Files (.xml <img src="../../images/xml.png" alt="XML Icon">)</li>
                            <li>JSON Files (.json <img src="../../images/json.png" alt="JSON Icon">)</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Future Milestone</h4>
                        <ul>
                            <li>Bootstrap HTML Files(.bootstrap.html <img src="../../images/bootstrap.png" alt="BOOTSTRAP Icon">)</li>
                            <li>PDF Documents (.pdf <img src="../../images/pdf.png" alt="PDF Icon">)</li>
                            <li>Google Documents (.doc <img src="../../images/doc.png" alt="DOC Icon">)</li>
                        </ul>            
                    </li>
                    <li><br></li>
                </ul>
            </li>
            <li><hr></li>

            <li><b>-source_info</b>:
                <ul style="list-style: none;">
                    <li>
                        <h4>Description:</h4>
                        <ul>
                            <li>Specifies the following details of the report:</li>
                            <li style="list-style: none;">
                                <ol>
                                    <li>Title</li>
                                    <li>By</li>
                                    <li>For</li>
                                    <li>Scan Date</li>
                                    <li>Report Date</li>
                                    <li>Scan Ver</li>
                                    <li>Report Ver</li>
                                    <li>Description</li>
                                </ol>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <h4>Example:</h4>
                        <ul>
                            <li>-source_info "Vulnerability Report of MyApp.com;JordanGS;Lost Souls;August 15, 2016;August 18, 2016;ZAP_D-2016-08-15;ZAP_D-2016-08-15;Lorem ipsum dolor sit amet, pri corpora ancillae adolescens in. Ea usu atomorum tincidunt, ne munere regione has. Ne sea summo tation, et sed nibh nostrum singulis. Nec causae viderer discere eu."</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Validation:</h4>
                        <ul>
                            <li>Content is unchecked, can enter empty fields if you wish, only condition is that all 8 items are in the list.</li>
                        </ul>
                    </li>
                    <li><br></li>
                </ul>
            </li>
            <li><hr></li>
            
            <li><b>-alert_severity</b>:
                <ul style="list-style: none;">
                    <li>
                        <h4>Description:</h4>
                        <ul>
                            <li>Specifies which alert severities will be included in the report:</li>
                            <li style="list-style: none;">
                                <ol>
                                    <li>High</li>
                                    <li>Medium</li>
                                    <li>Low</li>
                                    <li>Informational</li>
                                </ol>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <h4>Input format:</h4>
                        <ul>
                            <li>Only accepts a string list with ';' delimiter</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Input restriction:</h4>
                        <ul>
                            <li>Only accepts 't' and 'f' for each item in the list</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Example:</h4>
                        <ul>
                            <li>-alert_severity "t;t;f;t"</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Explanation:</h4>
                        <ul>
                            <li>In the above example, only High, Medium and Informational Alerts will be included in the generated report.</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Validation:</h4>
                        <ul>
                            <li>Validation: Content is validated to be either 't' or 'f' and that all 4 items are in the list.</li>
                        </ul>
                    </li>
                    <li><br></li>
                </ul>
            </li>
            <li><hr></li>
            
            <li><b>-alert_details</b>:
                <ul style="list-style: none;">
                
                    <li>
                        <h4>Description:</h4>
                        <ul>
                            <li>Specifies which alert details will be included in the report:</li>
                            <li style="list-style: none;">
                                <ol>
                                    <li>CWE ID</li>
                                    <li>WASC ID</li>
                                    <li>Description</li>
                                    <li>Other Info</li>
                                    <li>Solution</li>
                                    <li>Reference</li>
                                    <li>Request Header</li>
                                    <li>Response Header</li>
                                    <li>Request Body</li>
                                    <li>Response Body</li>
                                </ol>
                            </li>
                        </ul>
                    <li>
                    <li>
                        <h4>Input format:</h4>
                        <ul>
                            <li>Only accepts a string list with ';' delimiter</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Input restriction:</h4>
                        <ul>
                            <li>Only accepts 't' and 'f' for each item in the list</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Example:</h4>
                        <ul>
                            <li>-alert_details "t;t;t;t;t;t;f;f;f;f"</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Explanation:</h4>
                        <ul>
                            <li>In the above example, only CWE ID, WASC ID, Description, Other Info, Solution and Reference Alert Details will be included in the generated report.</li>
                        </ul>
                    </li>
                    <li>
                        <h4>Validation:</h4>
                        <ul>
                            <li>Content is validated to be either 't' or 'f' and that all 10 items are in the list.</li>
                        </ul>
                    </li>
                    <li><br></li>
                </ul>
            </li>
            <li><hr></li>
        </ul>

        <ul style="list-style: none;">
            <li>
                <h4>Putting it all together! (Windows)</h4>
                <ol>
                    <li>Open a command prompt</li>
                    <li>Navigate to location where the zap.bat file is located</li>
                    <li>execute the following:
                        <ul style="list-style: none;"><li>zap.bat <b>-export_report</b> "/path/to/save/report.xhtml" <b>-source_info</b> "Vulnerability Report of MyApp.com;JordanGS;Lost Souls;August 15, 2016;August 18, 2016;ZAP_D-2016-08-15;ZAP_D-2016-08-15;Lorem ipsum dolor sit amet, pri corpora ancillae adolescens in. Ea usu atomorum tincidunt, ne munere regione has. Ne sea summo tation, et sed nibh nostrum singulis. Nec causae viderer discere eu." <b>-alert_severity</b> "t;t;f;t" <b>-alert_details</b> "t;t;t;t;t;t;f;f;f;f" <b>-session</b> "/path/to/existing/session" <b>-cmd</b></li></ul>
                    </li>
                </ol>
            </li>
        </ul>

        <hr>

        <a name="api-calls"></a> 
        <h2><u>API Calls</u></h2>

        The extension can be accessed with API calls and requires the following arguments to be passed in to generate a report.

        <br><br>

        The restrictions are the same as those for Command Line above.

        <h4>Usage Example:</h4>
        <blockquote><pre><code>
Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
String API_KEY = "ZAPROXY-PLUGIN"
String absolutePath = "/path/to/save/report.xhtml";
String extension = "xhtml";
String sourceDetails = "Vulnerability Report of MyApp.com;JordanGS;Lost Souls;" +
    "August 15, 2016;August 18, 2016;ZAP_D-2016-08-15;ZAP_D-2016-08-15;" + 
    "Lorem ipsum dolor sit amet, pri corpora ancillae adolescens in. Ea " + 
    "usu atomorum tincidunt, ne munere regione has. Ne sea summo tation, " +
    "et sed nibh nostrum singulis. Nec causae viderer discere eu.";
String alertSeverity = "t;t;f;t";
String alertDetails = "t;t;t;t;t;t;f;f;f;f";

map.put("apikey", API_KEY);

// String representing the absolute path to save destination for the report
map.put("absolutePath", absolutePath)

// String representing the extension of the report
map.put("fileExtension", extension);

// String separated by ; for each entry
map.put("sourceDetails", sourceDetails);

// String separated by ; for each entry
map.put("alertSeverity", alertSeverity);

//String separated by ; for each entry
map.put("alertDetails", alertDetails);
</code></pre></blockquote>
<blockquote><code>ApiResponseElement val = (ApiResponseElement) clientApi.callApi("exportreport", "action", "generate", map);</code></blockquote>
    </body>
</html>