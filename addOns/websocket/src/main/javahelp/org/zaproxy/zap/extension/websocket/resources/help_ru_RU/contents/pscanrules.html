<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
    <HEAD>
        <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
        <TITLE>
            WebSocket Passive Scan Rules
        </TITLE>
    </HEAD>
    <BODY>
        <H1>Правила пассивного сканирования Websocket </H1>
        <h2 id="scripts">Сценарии</h2>
        Сценарии, которые включены по умолчанию в дополнении, и они реализуют следующие правила пассивного сканирования Websocket: 

        <h3>Base64 раскрытие </h3>

        Этот скрипт анализирует выгодную нагрузку входящей входящей загрузки WebSocket для строк Base64.  Кодированная информация может включать конфиденциальные данные, которые могут конкретно не предназначены для конечного потребления пользователя. <br>

         Регулярное выражение, которое используется для идентификации строки Base64, основано на характерах прокладки.  В результате может возникнуть ложноотрицательный результат, если закодированная строка имеет длину N бит, где (N)mod6 = 0.  С другой стороны, ложные срабатывания могут возникать, если входной текст содержит строки, оканчивающиеся на «=».  <br>

        <p>
        Примеры:
        <table border="1"  width = "500">
            <tr><th>Оригинал </th><th>Полезная нагрузка</th><th>Результат</th></tr>
            <tr><td>Привет Мир</td><td>SGVsbG8gV29ybGQ=</td><td>Истинный положительный </td></tr>
            <tr><td>Привет Мир</td><td>THIS_ISSGVsbG8gV29ybGQ=TEXT</td><td>Истинный положительный </td></tr>
            <tr><td>Привет Мир!</td><td>SGVsbG8gV29ybGQK</td><td>Ложноотрицательный </td></tr>
            <tr><td>122==122</td><td><i>Неверный</i></td><td>Ложный положительный результат</td>
        </table>

        <p>
        Значения по умолчанию: 
        <table border="1"  width = "500">
            <tr><td><strong>Риск</strong></td><td>Информация</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Средний</td></tr>
        </table>

        <h3>Раскрытие информации: ошибки приложения </h3>

        Этот пассивный сканер проверяет входящие полезные данные сообщений WebSocket на наличие известных сообщений об ошибках приложений.  Доступ к таким сведениям может предоставить злоумышленнику средства для дальнейшего злоупотребления веб-сайтом.  Они также могут привести к утечке данных, не предназначенных специально для конечного пользователя. <br>

        <p>
        Примеры:
        <table border="1"  width = "500">
            <tr><th>Вариант использования </th><th>Результат</th></tr>
            <tr><td>Предупреждение: нельзя изменить информацию заголовка — заголовки уже отправлены </td><td>Истинный положительный </td></tr>
            <tr><td>'это' равно нулю или не является объектом </td><td>Истинный положительный </td></tr>
            <tr><td>System.Data.OleDb.OleDbException: синтаксическая ошибка в строке в выражении запроса  'User ID = ? И Password = ?'</td><td>Истинный положительный </td></tr>
        </table>
        <p>
        Значения по умолчанию: 
        <table border="1"  width = "500">
            <tr><td><strong>Риск</strong></td><td>Средний</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Средний</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>209: Раскрытие информации через сообщение об ошибке </td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>13: Утечка информации </td></tr>
        </table>

        <h3>Раскрытие информации: номер кредитной карты</h3>

        Этот сценарий сканирует наличие личной информации, идентифицируемой во входящих полезных данных сообщения WebSocket.
        В частности, он пассивно сканирует полезную нагрузку на предмет номеров кредитных карт. Доступны сканы для следующих типов кредитных карт:
         {American Express, Diners Club, Discover, Jcb, Mestro, Master Card, Visa}.<br>

        <p>
        Примеры:
        <table border="1"  width = "500">
            <tr><th>Вариант использования </th><th>Результат</th></tr>
            <tr><td>5264 8109 66944441</td><td>Истинный положительный </td></tr>
            <tr><td>{"z":0.4333009597918351}
</td><td>False Positive</td></tr>
        </table>

        <p>
        Default Values:
        <table border="1"  width = "500">
            <tr><td><strong>Риск</strong></td><td>Высокий</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Высокий</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>359: Разглашение личной информации («Нарушение конфиденциальности»)</td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>13: Утечка информации</td></tr>
        </table>

        <h3>Раскрытие информации: ошибки отладки</h3>

        Этот сценарий проверяет полезные данные входящего сообщения WebSocket на наличие известных фрагментов сообщений об ошибках отладки. Доступ к таким сведениям может предоставить злоумышленнику средства для дальнейшего злоупотребления веб-сайтом. Они также могут привести к утечке данных, не предназначенных специально для конечного пользователя.<br>

        <p>
        Примеры:
        <table border="1"  width = "500">
            <tr><th>Вариант использования </th><th>Результат</th></tr>
            <tr><td>Ошибка при обработке запроса</td><td>Истинный положительный </td></tr>
            <tr><td>Предупреждение PHP: ошибка при отправке пакета QUERY</td><td>Истинный положительный </td></tr>
        </table>

        <p>
        Значения по умолчанию: 
        <table border="1"  width = "500">
            <tr><td><strong>Риск</strong></td><td>Информация</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Средний</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>200: Информационное воздействие</td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>13: Утечка информации</td></tr>
        </table>

        <h3>Раскрытие информации: адрес электронной почты</h3>

        Этот сценарий сканирует входящие сообщения WebSocket на наличие адресов электронной почты. Адреса электронной почты могут быть не предназначены для использования конечными пользователями.<br>

        <p>
        Значения по умолчанию: 
        <table border="1"  width = "400">
            <tr><td><strong>Риск</strong></td><td>Информация</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Информация</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>200: Информационное воздействие</td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>13: Утечка информации </td></tr>
        </table>

        <h3>Раскрытие информации: подозрительные комментарии XML</h3>

        Этот сценарий проверяет полезные данные входящих сообщений WebSocket в формате XML на наличие подозрительных комментариев. Комментарии, которые он ищет, относятся к компонентам, с помощью которых злоумышленник может извлечь полезную информацию. Такие комментарии, как FIXME, BUG и т. д., могут быть полезны для дальнейших атак, нацеленных на слабые места веб-приложения.<br>

        <p>
        Примеры:
        <table border="1"  width = "500">
            <tr><th>Вариант использования</th><th>Результат</th></tr>
            <tr><td>
                <pre>&lt;xml_test&gt;&lt;!-- Это раздел комментариев --&gt;&lt;/xml_test&gt;</pre>
            </td><td>Правда отрицательный</td>
            </tr>
            <tr><td>
                <pre>&lt;user_form&gt;&lt;!-- FIXME: Кодировать --&gt;&lt;/user_form&gt;</pre>
            </td><td>Истинный положительный </td>
            </tr>
        </table>

        <p>
        Значения по умолчанию: 
        <table border="1"  width = "500">
            <tr><td><strong>Риск</strong></td><td>Информация</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Средний</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>200: Информационное воздействие</td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>13: Утечка информации</td></tr>
        </table>

        <h3 id="ip_add_disc">Раскрытие частного адреса</h3>
        Проверяет полезные данные входящего сообщения WebSocket на предмет включения IPv4-адресов RFC 1918, а также частных имен хостов Amazon EC2 (например, ip-10-0-56-78). Эта информация может дать злоумышленнику полезную информацию о схеме IP-адресов внутренней сети и может быть полезной для дальнейших атак, направленных на внутренние системы. <br>

         Этот пассивный сканер может генерировать ложные срабатывания в случае больших числовых строк с точками, таких как vp09.02.51.10.01.09.16, где последние 4 октета представляют собой IPv4-адрес RFC 1918. 
<0> После просмотра аналитик может пометить такие оповещения как False Positives в ZAP.<br>
        <p>
        Примеры:
        <table border="1"  width = "200">
            <tr><th>Вариант использования</th><th>Результат</th></tr>
            <tr><td>10.255.255.255</td><td>Истинный положительный </td></tr>
            <tr><td>ip-10.0.0.0</td><td>Истинный положительный </td></tr>
        </table>
        <p>
        Значения по умолчанию: 
        <table border="1"  width = "200">
            <tr><td><strong>Риск</strong></td><td>Низкий</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Средний</td></tr>
        </table>

        <h3>Раскрытие имени пользователя</h3>

        Проверяет полезные данные входящих сообщений WebSocket на наличие имен пользователей. Этот скрипт может найти имена пользователей, хешированные следующими методами:
         {MD2, MD5, SHA256, SHA384, SHA512}. Имена пользователей должны быть определены в любом контексте заранее. Чтобы добавить пользователя в Context, выполните следующие действия:
        <ol>
            <li>Включите запрос рукопожатия в `Context` </li>
            <li>Установите целевого пользователя в `Контексте сеанса` </li>
        </ol>

        <p>
        Значения по умолчанию: 
        <table border="1"  width = "400">
            <tr><td><strong>Риск</strong></td><td>Информация</td></tr>
            <tr><td><strong>Уверенность </strong></td><td>Высокий</td></tr>
            <tr><td><strong>CWE Идентификатор</strong></td><td>284: Неправильный контроль доступа</td></tr>
            <tr><td><strong>WASC-идентификатор </strong></td><td>2: Недостаточная авторизация</td></tr>
        </table>
        
    </BODY>
</HTML>
