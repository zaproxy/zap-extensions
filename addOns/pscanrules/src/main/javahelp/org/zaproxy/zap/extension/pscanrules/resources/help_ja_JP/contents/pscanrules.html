<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>
パッシブスキャンルール
</title>
</head>
<body>
<h1>パッシブスキャンルール</h1>

<h2>全般設定</h2>

<h3>信頼済みドメイン</h3>
オプションの「ルール設定」パネルから <code>rules.domains.trusted</code> パラメーターを使用して、カンマ区切りのURL正規表現パターンリストを指定できます。
これらのパターンに一致するリンクURLは信頼済みドメインと見なされ、アラートの対象外となります。
 以下のルールが <b>信頼済みドメイン</b> をサポートしています：
<ul>
 <li>クロスドメインスクリプト・インクルージョン</li>
 <li>リバース・タブナビング</li>
</ul>

<hr>

このアドオンには以下のリリース状態のパッシブスキャンルールが含まれています：

<h2 id="id-10020">クリックジャッキング対策ヘッダー</h2>
このスキャンルールは、X-Frame-Optionsヘッダー、または Content-Security-Policy の 'frame-ancestors' ディレクティブの存在と妥当性をチェックします。<br> 
MEDIUM および HIGH しきい値では、エラーやリダイレクト以外のHTMLレスポンスのみを調べます。<br>
LOW しきい値では、エラーやリダイレクトを含むすべてのテキストレスポンスを調べます。<br>
以下の状態でアラートが発生する可能性があります：
<ul> 
 <li><b>Missing Anti-clickjacking Header</b>: X-Frame-Optionsヘッダーがレスポンスに完全に欠落している場合。</li>
 <li><b>Multiple X-Frame-Options Header Entries</b>: レスポンスに複数の X-Frame-Options ヘッダーが検出された場合。</li>
 <li><b>X-Frame-Options Defined via META (Non-compliant with Spec)</b>: 仕様でサポートされていない X-Frame-Options を定義しようとする "http-equiv" エントリがレスポンスで見つかった場合。</li>
 <li><b>X-Frame-Options Setting Malformed</b>: ヘッダーが値なしで存在する場合、または値が期待通りでない場合 (つまり、"DENY" または "SAMEORIGIN" 以外)。</li>
</ul>
デフォルトでは、レスポンスに Content-Security-Policy の 'frame-ancestors' 要素が含まれている場合、アラートは発生しません。これは X-Frame-Options ヘッダーより優先されるためです。
ただし、LOW しきい値では上記の問題が依然として報告されますが、リスクはLOWになります。 
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/AntiClickjackingScanRule.java">AntiClickjackingScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10020/">10020</a>

<h2 id="id-90022">アプリケーションエラー</h2>
HTTP 500 - Internal Server Errorタイプのレスポンス、または既知のエラー文字列を含むレスポンスをチェックします。 <br>
<strong>注:</strong> スクリプトブロックやファイル内のマッチは、コメントだけでなくコンテンツ全体が対象となります。<br>
ISO制御文字（バイナリファイルの可能性が高いもの）を含むレスポンスはスキップされます。<br>
HIGH しきい値では、HTTP 500ではアラートを出しません (ただし、他のエラーパターンでは出します)。 また、既知のエラー文字列はJS/CSSなどの静的ページではあまり関連性がないため、これらのファイルはLOW しきい値でのみスキャンされます。<br>
Internal Server Error (HTTP 500) の場合、アラートは低リスクに設定され、その他の場合は中リスクに設定されます。

<p><strong>注:</strong> カスタムペイロードアドオンがインストールされている場合、カスタムペイロードオプションパネルで独自の Application Error の文字列 (ペイロード) を追加できます。 
これらもパッシブスキャン実行時にレスポンス内で検索されます。 パッシブスキャン時にレスポンス内でこれらも検索されます。ペイロード数が多いほど、パッシブスキャンに必要な時間が長くなることに注意してください。<br>
このルールの カスタムペイロード カテゴリ: <code>Application-Errors</code>.
<p>ZAPのユーザーディレクトリの <code>xml/application_errors.xml</code> ファイルにパターンを追加することも可能です。<br>
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ApplicationErrorScanRule.java">ApplicationErrorScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90022/">90022</a>

<h2 id="id-10044">サイズの大きなリダイレクトを検出 (機密情報漏洩の可能性)</h2>
このチェックは、さまざまなリダイレクトタイプのレスポンスのサイズを予測し、レスポンスが予測サイズより大きい場合にアラートを生成します。 
大きなリダイレクトレスポンスは、リダイレクトが行われたにもかかわらず、ページに実際にはコンテンツ (機密情報、PIIなどを含む可能性がある) が含まれていることを示す可能性があります。
また、リダイレクトレスポンスの本文に複数のHREFが含まれている場合もアラートを発生させます。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/BigRedirectsScanRule.java">BigRedirectsScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10044/">10044</a>

<h2 id="id-10015">Cache Control</h2>
"Cache-Control"レスポンスヘッダーを、機密コンテンツの保護のための一般的な業界ベストプラクティス設定と照らし合わせてチェックします。<br>
MEDIUM および HIGH しきい値では、エラーやリダイレクト以外のテキストレスポンス (JavaScriptとCSSを除く) のみが対象となります。<br>
LOW しきい値では、エラーやリダイレクトを含むすべてのレスポンスが対象となります。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CacheControlScanRule.java">CacheControlScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10015/">10015</a>

<h2 id="id-90011">文字セットの不一致</h2>
<p>このチェックは、HTTPの Content-Type ヘッダーで宣言されている charset が、HTMLまたはXMLの本文で定義されている charset と異なるレスポンスを識別します。 HTTPヘッダーとコンテンツ本文の間に charset の不一致がある場合、Webブラウザは望ましくないコンテンツスニッフィングモードに強制され、コンテンツの正しい文字セットを判断することになります。</p>
<p>スキャンルールはルールに設定されたしきい値に応じて、さまざまな状態を処理します：</p>
<ul>
  <li>すべてのしきい値：
    <ul>
      <li>ヘッダーとMETAコンテンツタイプ文字セットの矛盾 - HTTPの Content-Type ヘッダーの宣言が、METAの Content-Type タグで宣言されているものと一致しない。</li>
      <li>ヘッダーとMETAの文字セットの対立 - HTTPの Content-Type ヘッダーの宣言が、METAの Charset タグで宣言されているものと一致しない。</li>
    </ul>
  </li>
  <li>Low しきい値：
    <ul>
      <li>META文字セットとMETAコンテンツタイプ文字セットの矛盾 - レスポンスにMETAの Content-Type 宣言とMETAの Charset 宣言の両方が含まれており、それらが一致しない。</li>
    </ul>
  </li>
</ul>
参考資料：<br>
<a href="http://www.w3.org/TR/html401/charset.html#h-5.2.2">http://www.w3.org/TR/html401/charset.html#h-5.2.2</a><br>
<a href="http://www.w3.org/TR/html5/document-metadata.html#charset">http://www.w3.org/TR/html5/document-metadata.html#charset</a>
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CharsetMismatchScanRule.java">CharsetMismatchScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90011/">90011</a>

<h2 id="id-10038">Content Security Policy (CSP) ヘッダーが設定されていない</h2>
このチェックは、HTMLレスポンスヘッダーに Content Security Policy ヘッダーが存在するか、またはレスポンス本文にMETAタグを介して指定されたCSPが存在するかを確認します。<br>
デフォルトでは、このルールは "Content-Security-Policy"、"X-Content-Security-Policy"、"X-WebKit-CSP" ヘッダーの存在をチェックします。 Low しきい値を除き、リダイレクトおよび非HTMLレスポンスは無視されます。
<p>
"Content-Security-Policy" ヘッダーが見つからない場合、アラートが発生します。
<p>
"X-Content-Security-Policy" または "X-WebKit-CSP" ヘッダーが見つかった場合、INFOアラートが発生します。これは古い実装を表している可能性があります。
<p>
レスポンスに "Content-Security-Policy-Report-Only" ヘッダーが見つかった場合、INFOアラートが発生します。 これは、積極的に改良または開発されている、または部分的にのみ実装されている実施の取り組みを表している可能性があります。
<p>
注: このルールは、指定されたポリシーの実際の分析を行いません。それについては、CSPスキャンルールが有効になっていることを確認してください。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ContentSecurityPolicyMissingScanRule.java">ContentSecurityPolicyMissingScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10038/">10038</a>

<h2 id="id-10019">Content-Type ヘッダーの欠落</h2>
レスポンスに Content-Type ヘッダーが欠落している場合、またはヘッダーは存在するが値が空の場合にアラートを発生させます。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ContentTypeMissingScanRule.java">ContentTypeMissingScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10019/">10019</a>

<h2 id="id-10010">CookieにHttpOnlyフラグがない</h2>
Cookieが設定される際にHttpOnlyフラグが付けられていることを確認します。 HttpOnlyフラグは、設定されているCookieがクライアント側スクリプト (JavaScriptなど) によって操作されるべきでないことをブラウザに示します。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieHttpOnlyScanRule.java">CookieHttpOnlyScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10010/">10010</a>

<h2 id="id-90033">Cookie - 広いスコープ</h2>
Cookieはドメインまたはパスでスコープを設定できます。 このチェックはドメインスコープのみに関係します。Cookieに適用されるドメインスコープは、どのドメインがそれにアクセスできるかを決定します。 例えば、Cookieはサブドメインに厳密にスコープを設定できます (例: <code>www.nottrusted.com</code>)、または親ドメインに緩くスコープを設定できます (例: <code>nottrusted.com</code>)。 後者の場合、<code>nottrusted.com</code>の任意のサブドメインがCookieにアクセスできます。 緩くスコープされたCookieは、<code>google.com</code>や<code>live.com</code>のようなメガアプリケーションでは一般的です。.
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieLooselyScopedScanRule.java">CookieLooselyScopedScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90033/">90033</a>

<h2 id="id-10029">Cookieポイズニング</h2>
このチェックは、クエリ文字列パラメータとPOSTデータのユーザー入力を調べて、Cookieパラメータが制御される可能性がある場所を特定します。 
これはCookie poisoning攻撃と呼ばれ、攻撃者がさまざまな方法でCookieを操作できる場合に悪用可能になります。 場合によっては悪用できないこともありますが、URLパラメータでCookie値を設定できるようにすることは、一般的にバグと見なされます。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UserControlledCookieScanRule.java">UserControlledCookieScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10029/">10029</a>

<h2 id="id-10011">Cookie Secureフラグ</h2>
HTTPSセッション中に設定されたCookieを調べ、secureフラグが含まれていないものについてアラートを発生させます。
secureフラグが設定されたCookieは、プレーンなHTTPセッション中には送信されません。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieSecureFlagScanRule.java">CookieSecureFlagScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10011/">10011</a>.

<h2 id="id-10054">SameSite属性のないCookie</h2>
以下のCookieを報告します：
<ul>
  <li>SameSite属性を持たないもの</li>
  <li>属性が "None" に設定されているもの (HIGH しきい値では無視)</li>
  <li>認識された有効な値を持たないもの</li>
</ul>
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieSameSiteScanRule.java">CookieSameSiteScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10054/">10054</a>.

<h2 id="id-10017">クロスドメインスクリプト・インクルージョン</h2>
HTMLレスポンスの "script" タグの "src" 属性を調べて、コンテンツをホストしているドメイン以外のドメインからスクリプトが含まれているかどうかを検証します。<br>
許可されるクロスドメインスクリプト：  
<ul>
<li>空でない "integrity" 属性を持つスクリプトは無視されます - integrity値はブラウザによってチェックされるため、ここではチェックされません</li>
<li>MEDIUM および HIGH しきい値では、スクリプトURLがベースメッセージのURLも含むコンテキスト内にある場合、アラートは発生しません</li>
<li>このルールは<b>信頼済みドメイン</b>をサポートしています。詳細については「全般設定」を確認してください。</li>
</ul> 
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CrossDomainScriptInclusionScanRule.java">CrossDomainScriptInclusionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10017/">10017</a>

<h2 id="id-10098">クロスドメイン設定ミス</h2>
レスポンスをパッシブスキャンして、Webブラウザで同一オリジンポリシーを緩和するクロスドメイン誤設定を検出します。<br>
現在の実装では、過度に寛容なCORSヘッダーを調べます。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CrossDomainMisconfigurationScanRule.java">CrossDomainMisconfigurationScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10098/">10098</a>

<h2 id="id-10055">CSP (Content Security Policy)</h2>
Content Security Policy (CSP) パッシブスキャンルールは、CSPヘッダーとMETA定義を解析および分析して、潜在的な誤設定や弱点を検出します。 このルールは、HtmlUnitの<a href="https://github.com/HtmlUnit/htmlunit-csp">htmlunit-csp</a>ライブラリを活用してCSPの解析と評価を行います。
<p>
レスポンスに複数のCSPがある場合、それぞれが個別に分析されます。ポリシーを交差/マージする確実な方法がなく、さらにブラウザによってCSPのサポートと実施レベルが異なるためです。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ContentSecurityPolicyScanRule.java">ContentSecurityPolicyScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10055/">10055</a>.

<h2 id="id-10202">CSRF対策</h2>
このルールは、フォームを持つHTMLページに既知のCSRF対策が欠如している「潜在的な」脆弱性を識別します。<br>
このルールはHTMLページでないメッセージはスキャンしません。<br>
HIGHアラートしきい値では、スコープ内のメッセージのみをスキャンします。<br>
バージョン2.5.0以降、Optionsの「ルール設定」パネルで 
<code> rules.csrf.ignorelist</code> パラメーターを使用して、カンマ区切りのURL正規表現パターンリストを指定できます。
これらの識別子のいずれかに一致する name または ID を持つFORMは、Anti-CSRFトークンの欠落をスキャンする際に無視されます。
この機能は、検索フォームなど、安全であることが確認されているFORMを無視する場合にのみ使用してください。
フォーム要素名は、ZAPレポートに出力される際にソートおよび重複排除されます。
<br>
注:
<ul>
    <li>このルールは、Anti-CSRFオプション内の部分一致設定も考慮に入れます</li>
    <li>GET経由で送信されるフォームは、Lowしきい値でのみ評価されます</li>
</ul>

<p>
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CsrfCountermeasuresScanRule.java">CsrfCountermeasuresScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/100202/">100202</a>

<h2 id="id-10033">ディレクトリブラウジング</h2>
ディレクトリブラウジングが可能であることを示すシグネチャをレスポンスからパッシブスキャンします。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/DirectoryBrowsingScanRule.java">DirectoryBrowsingScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10033/">10033</a>.

<h2 id="id-10097">ハッシュの露見</h2>
Webサーバーによって開示されたパスワードハッシュをパッシブスキャンします。 <br>
MD4、MD5、SHA*など、パスワードハッシュ以外の目的で使用されることがあるフォーマットを含む、さまざまなフォーマットが含まれています。
<br>
<strong>注:</strong>
<ul>
    <li>このスキャンルールはテキストレスポンスのみを分析し、JavaScriptレスポンスはLOWしきい値でのみ分析します<li>
    <li>評価されるハッシュパターンの選択は、パターンに対する信頼度とスキャンルールに設定されたしきい値に関連しています。
        言い換えると、信頼度の低いパターンはLowしきい値でのみ評価対象に含まれます。</li>
</ul> 
<p>
最新のコード:  <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/HashDisclosureScanRule.java">HashDisclosureScanRule.java</a><br>
アラートID:  <a href="https://www.zaproxy.org/docs/alerts/10097/">10097</a>

<h2 id="id-10034">Heartbleed OpenSSL の脆弱性 (指標)</h2>
サーバーが重大なHeartBleed OpenSSL脆弱性に対して脆弱である可能性を示すHTTPヘッダーレスポンスをパッシブスキャンします。 
<p>
最新のコード:  <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/HeartBleedScanRule.java">HeartBleedScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10034/">10034</a>

<h2 id="id-10036">HTTPサーバーレスポンスヘッダー</h2>
レスポンスヘッダーでバージョン詳細を含むサーバーヘッダーの存在をチェックします。
LOWしきい値では、バージョン文字列が検出されたかどうかに関わらず、ヘッダーフィールドの存在に基づいてアラートを発生させます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ServerHeaderInfoLeakScanRule.java">ServerHeaderInfoLeakScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10036/">10036</a>

<h2 id="id-10041">フォーム送信におけるHTTPからHTTPSへの安全でない遷移</h2>
このチェックは、HTTPSフォームをホストする安全でないHTTPページを探します。 問題は、安全でないHTTPページがMITMを通じて簡単にハイジャックされ、安全なHTTPSフォームが置き換えられたり偽装されたりする可能性があることです。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InsecureFormLoadScanRule.java">InsecureFormLoadScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10041/">10041</a>

<h2 id="id-10042">フォーム送信におけるHTTPSからHTTPへの安全でない遷移</h2>
このチェックは、安全でないHTTPフォームをホストする安全なHTTPSページを識別します。 問題は、フォームを通じてデータがアップロードされる際に、安全なページから安全でないページに移行していることです。 ユーザーは安全なページにデータを送信していると思っているかもしれませんが、実際にはそうではありません。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InsecureFormPostScanRule.java">InsecureFormPostScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10042/">10042</a>

<h2 id="id-10023">情報漏洩: デバッグエラー</h2>
このパッシブスキャンルールは、既知のデバッグエラーメッセージフラグメントについてWebレスポンスのコンテンツをチェックします。
このような詳細へのアクセスは、悪意のある個人にWebサイトをさらに悪用する手段を与える可能性があります。
また、エンドユーザーの消費を特に意図していないデータが漏洩する可能性があります。<br>
注意: JavaScriptレスポンスはLOWしきい値でのみ評価されます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InformationDisclosureDebugErrorsScanRule.java">InformationDisclosureDebugErrorsScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10023/">10023</a>

<h2 id="id-10024">情報漏洩 - URL内の機密情報</h2>
訪問したURI自体に機密の詳細が存在するかどうかを識別しようとします (これにはパラメータ、ドキュメント名、ディレクトリ名などが含まれる可能性があります)。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InformationDisclosureInUrlScanRule.java">InformationDisclosureInUrlScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10024/">10024</a>

<h2 id="id-10025">情報漏洩 - HTTP Referrerヘッダー内の機密情報</h2>
HTTPリクエストの Referrer ヘッダーフィールド内に機密の詳細が存在するかどうかを識別します (これにはパラメータ、ドキュメント名、ディレクトリ名などが含まれる可能性があります)。
<p>
注意: Referrer値に疑わしいクレジットカード識別子がある場合、潜在的なクレジットカード番号は銀行識別番号リスト (BINList) と照合されます。 一致が見つかった場合、アラートは高信頼度で発生し、アラートの「その他の情報」フィールドに追加の詳細が追加されます。そうでない場合、アラートは中信頼度になります。
詳細については<a href="https://github.com/iannuttall/binlist-data">binlist-data</a>を参照してください。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InformationDisclosureReferrerScanRule.java">InformationDisclosureReferrerScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10025/">10025</a>

<h2 id="id-10027">情報漏洩 - 疑わしいコメント</h2>
Webコンテンツを分析して、潜在的に機密の詳細を含むコメントを識別します。 これにより、さらなる攻撃や意図しないデータの暴露につながる可能性があります。
<p><strong>注意:</strong> 検索する文字列は「カスタムペイロード」アドオンを使用して拡張できます。<br>
このルールの「カスタムペイロード」カテゴリ: <code>Suspicious-Comments</code>.
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InformationDisclosureSuspiciousCommentsScanRule.java">InformationDisclosureSuspiciousCommentsScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10027/">10027</a>

<h2 id="id-10105">安全でない認証</h2>
HTTPベーシック認証またはダイジェスト認証が安全でない接続で使用されています。 認証情報はネットワークにアクセスできる誰かによって読み取られ、再利用される可能性があります。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InsecureAuthenticationScanRule.java">InsecureAuthenticationScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10105/">10105</a>

<h2 id="id-90001">安全でないJSF ViewState</h2>
レスポンスに、暗号化保護がないJava Server Faces (JSF) ViewState値が含まれています。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InsecureJsfViewStatePassiveScanRule.java">InsecureJsfViewStatePassiveScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90001/">90001</a>

<h2 id="id-10040">混在コンテンツ</h2>
HTTPS経由で提供されるコンテンツについて、レスポンス内のすべての src 属性を分析し、プレーンHTTP経由で取得されるものを探します。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/MixedContentScanRule.java">MixedContentScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10040/">10040</a>

<h2 id="id-10109">モダンWebアプリケーション</h2>
サイトが最新のWebアプリケーションであると思われる場合に、情報提供のアラートを発生させます。<br>
潜在的な脆弱性を示すものではありませんが、従来のスパイダーと比較して、Ajaxスパイダーがこのサイトをより効果的に探索できる可能性があることを示しています。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ModernAppDetectionScanRule.java">ModernAppDetectionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10109/">10109</a>

<h2 id="id-10028">外部サイトへのリダイレクト</h2>
このチェックは、クエリ文字列パラメータとPOSTデータのユーザー入力を調べて、オープンリダイレクトが可能な場所を特定します。 オープンリダイレクトは、アプリケーションがユーザー入力 (例: http://nottrusted.com) でオフサイトの宛先を制御できるようにする場合に発生します。 これは通常、スパマーやフィッシング攻撃によって301または302リダイレクトが悪用される可能性がある場所を見つけるかなり正確な方法です。
<p>
<strong>注意</strong>: パッシブチェックの目的では、オリジンと宛先のオーソリティ部分が比較されました。この発見の影響を検証するには、手動テストが必要になる場合があります。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UserControlledOpenRedirectScanRule.java">UserControlledOpenRedirectScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10028/">10028</a>

<h2 id="id-10062">個人識別用情報の漏洩</h2>
PIIは、クレジットカード番号、SSNなどの情報です。 このチェックは現在、クレジットカード番号に一致し、Luhnチェックサムに合格する番号のみを報告します。
<br>
MEDIUMおよびHIGHしきい値では、潜在的な一致の両側の3文字のコンテキストを使用して、10進数のようなコンテンツやアンダースコアを含むコンテンツ内の一致を除外しようとします。
LOWしきい値では、そのような一致に対してもアラートが発生します。
<p>
MEDIUMおよびHIGHしきい値では、以下のコンテンツタイプが評価されます：
<ul>
    <li>HTML (可視テキストとスクリプトブロック)</li>
    <li>JSON</li>
    <li>XML</li>
</ul>
画像およびCSSファイルは常に無視されます。
その他のすべてのコンテンツタイプは、LOWしきい値で評価されます。さらに、LOWしきい値ではHTML全体のレスポンスが評価されます。
<p>
注: 疑わしいクレジットカード値の場合、潜在的なクレジットカード番号は銀行識別番号リスト (BINList) と照合されます。 一致が見つかった場合、アラートは高信頼度で発生し、アラートの「その他の情報」フィールドに追加の詳細が追加されます。そうでない場合、アラートは中信頼度になります。
詳細については<a href="https://github.com/iannuttall/binlist-data">binlist-data</a>を参照してください。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/PiiScanRule.java">PiiScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10062/">10062</a>

<h2 id="id-2">プライベートアドレスの漏洩</h2>
レスポンスコンテンツに、RFC 1918 IPv4アドレスやAmazon EC2プライベートホスト名 (例: ip-10-0-56-78) が含まれているかどうかをチェックします。 この情報により、攻撃者は内部ネットワークのIPアドレススキームに関する有用な情報を得ることができ、内部システムを標的としたさらなる攻撃に役立つ可能性があります。
<p>
このパッシブスキャンルールは、vp09.02.51.10.01.09.16のような大きなドット区切りの数値文字列の場合に誤検出 (偽陽性) を生成する可能性があります。ここでは、後半の4オクテットがRFC 1918 IPv4アドレスのように見えます。 
アナリストはレビュー後、ZAPでそのようなアラートを誤検知としてマークすることができます。 繰り返しスキャン中の処理については、「コンテキストアラートフィルター」アドオンを活用できます。
<p>
このスキャンルールはテキストレスポンスのみを分析します。 
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InfoPrivateAddressDisclosureScanRule.java">InfoPrivateAddressDisclosureScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/2/">2</a>

<h2 id="id-10050">キャッシュから取得</h2>
このスキャンルールは、共有キャッシュから提供されたコンテンツを検出します。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/RetrievedFromCacheScanRule.java">RetrievedFromCacheScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10050/">10050</a>

<h2 id="id-10108">リバース・タブナビング</h2>
"rel" 属性で "opener" キーワードを使用する target 属性を使用するリンクがあるかどうかをチェックします。これにより、ターゲットページがそれらを開いたページを乗っ取ることができる可能性があります。<br>
デフォルトでは、このルールはページと同じコンテキストにあるすべてのリンクを無視します。 LOWしきい値では、同じホスト上のリンクのみを無視します。<br>
HIGHしきい値では、"_blank" ターゲットを使用するリンクのみを報告します。<br>
このルールは<b>信頼できるドメイン</b>をサポートしています。詳細については「全般設定」を確認してください。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/LinkTargetScanRule.java">LinkTargetScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10108/">10108</a>

<h2 id="id-10115">悪意のあるドメインから配信されたスクリプト (polyfill)</h2>
これは、侵害されたことが知られている 'polyfill' ドメインのいずれかから提供されているスクリプトをチェックします。<br>
悪意のあるドメインのいずれかからスクリプトがロードされている場合は高信頼度でアラートを発生させ、スクリプトの内容に悪意のあるドメインのいずれかへの見かけ上の参照が見つかった場合は低信頼度でアラートを発生させます。
<p>
既知の悪意のある 'polyfill' ドメイン：
<ul>
<li>polyfill.io</li>
<li>bootcdn.net</li>
<li>bootcss.com</li>
<li>staticfile.net</li>
<li>staticfile.org</li>
<li>unionadjs.com</li>
<li>xhsbpza.com</li>
<li>union.macoms.la</li>
<li>newcrbpc.com</li>
</ul>
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/PolyfillCdnScriptScanRule.java">PolyfillCdnScriptScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10115/">10115</a>

<h2 id="id-10037">サーバーが "X-Powered-By" HTTPレスポンスヘッダーフィールド経由で情報を漏洩</h2>
レスポンスヘッダーに X-Powered-By の詳細が存在するかどうかをチェックします。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XPoweredByHeaderInfoLeakScanRule.java">XPoweredByHeaderInfoLeakScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10037/">10037</a>

<h2 id="id-3">URLリライト内のセッションID</h2>
このスキャンルールは、セッショントークンタイプのパラメータがURLに書き換えられて存在するかどうかをチェックします。 
誤検出を減らすために、ルールはトークン値の長さをチェックします。パラメータの値が8文字を超えない場合、そのパラメータは無視されます (つまり、survey?sId=5 は脆弱としてフラグ付けされません)。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/InfoSessionIdUrlScanRule.java">InfoSessionIdUrlScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/3/">3</a>.

<h2 id="id-10035">Strict-Transport-Security ヘッダー</h2>
このルールは、HTTPSレスポンスにHTTP Strict Transport Security (HSTS) ヘッダーが存在するかどうかをチェックし、さまざまな実装上の懸念をテストして、見つかった場合にアラートを発生させます。

生成されるアラート：
<ul>
 <li><b>Strict-Transport-Security Header Not Set:</b> レスポンスがHTTPSで、ヘッダーが完全に欠落している場合。</li>
 <li><b>Strict-Transport-Security Disabled:</b> レスポンスがHTTPSで、max-age 値がゼロに設定されており、サイトのブラウザのHSTS情報をリセットしている場合。</li>
 <li><b>Strict-Transport-Security Multiple Header Entries (Non-compliant with Spec):</b> レスポンスがHTTPSで、レスポンスに複数のHSTSヘッダーがある場合。</li>
 <li><b>Strict-Transport-Security Missing Max-Age (Non-compliant with Spec):</b> レスポンスがHTTPSで、HSTSヘッダーが指定されているが、max-age 値に数値が含まれていない場合。</li>
 <li><b>Strict-Transport-Security Defined via META (Non-compliant with Spec):</b> レスポンス本文にHSTSを定義しようとするMETAタグが含まれている場合。</li>
 <li><b>Strict-Transport-Security Header on Plain HTTP Response:</b> レスポンスがHTTPで、HSTSヘッダーが存在する場合。</li>
 <li><b>Strict-Transport-Security Max-Age Malformed (Non-compliant with Spec):</b> レスポンスがHTTPSで、HSTSヘッダーが存在するが、max-age ディレクティブの前に引用符がある場合 (引用符は max-age 値の周りでは許可されますが、ディレクティブ自体の周りでは許可されません)。</li>
 <li><b>Strict-Transport-Security Malformed Content (Non-compliant with Spec):</b> レスポンスがHTTPSで、HSTSヘッダーが存在するが、予期しないコンテンツ (巻き引用符など) がある場合。 印字可能なASCIIであることが期待されます。</li>
</ul>

同じドメイン上のHTTPS URLへのリダイレクトは、Lowしきい値でのみ報告されます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/StrictTransportSecurityScanRule.java">StrictTransportSecurityScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10035/">10035</a>

<h2 id="id-10096">タイムスタンプの露見</h2>
アプリケーション/Webサーバーによってタイムスタンプが開示されました。<br>
HIGHしきい値では、このルールはプラスまたはマイナス1年の範囲内にない潜在的なタイムスタンプではアラートを出しません。<br>
HIGHしきい値では、このルールはJavaScriptファイル内のタイムスタンプを無視します。<br>
MEDIUMしきい値では、このルールは10年を超える潜在的なタイムスタンプではアラートを出しません。<br>
すべてのしきい値で、このルールはY2038エポックエッジを超えるタイムスタンプではアラートを出しません。<br>

<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/TimestampDisclosureScanRule.java">TimestampDisclosureScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10096/">10096</a>

<h2 id="id-10030">ユーザーが制御可能な文字コード</h2>
このチェックは、クエリ文字列パラメータとPOSTデータのユーザー入力を調べて、Content-Type または meta タグの charset 宣言がユーザーによって制御される可能性がある場所を特定します。 このような charset 宣言は、常にアプリケーションによって宣言されるべきです。 攻撃者がレスポンスの charset を制御できる場合、HTMLを操作してXSSやその他の攻撃を実行できる可能性があります。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UserControlledCharsetScanRule.java">UserControlledCharsetScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10030/">10030</a>

<h2 id="id-10031">ユーザーが制御可能なHTML要素属性 (XSSの可能性)</h2>
このチェックは、クエリ文字列パラメータとPOSTデータのユーザー入力を調べて、特定のHTML属性値が制御される可能性がある場所を特定します。 これは、XSS (クロスサイトスクリプティング) のホットスポット検出を提供し、悪用可能性を判断するにはセキュリティアナリストによるさらなるレビューが必要です。
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UserControlledHTMLAttributesScanRule.java">UserControlledHTMLAttributesScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10031/">10031</a>

<h2 id="id-10043">ユーザーが制御可能なJavaScriptイベント (XSS)</h2>
このチェックは、クエリ文字列パラメータとPOSTデータのユーザー入力を調べて、特定のHTML属性値が制御される可能性がある場所を特定します。 これは、XSS (クロスサイトスクリプティング) のホットスポット検出を提供し、悪用可能性を判断するにはセキュリティアナリストによるさらなるレビューが必要です。            
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UserControlledJavascriptEventScanRule.java">UserControlledJavascriptEventScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10043/">10043</a>

<h2 id="id-10057">ユーザー名ハッシュの検出</h2>
コンテキストに定義されたユーザーが含まれている場合、このスキャンルールはすべてのレスポンスでそれらのユーザー名を表すハッシュ値の存在をチェックします。
<p><strong>注:</strong> カスタムペイロードアドオンがインストールされている場合、カスタムペイロードオプションパネルで独自のUsername 文字列 (ペイロード) を追加できます。 
パッシブスキャン時にレスポンス内でこれらもハッシュ化され検索されます。 ペイロード数が多いほど、パッシブスキャンに必要な時間が長くなることに注意してください。 （デフォルトのペイロードは "Admin" と "admin" です。）<br>
このルールのカスタムペイロードカテゴリ: <code>Username-Idor</code>.<br>
<p>このような値の発見は、Insecure Direct Object Reference (IDOR) 脆弱性を表している可能性があります。 アラートは、影響を確認および評価するためにさらなる手動テストが必要なため、情報提供項目としてのみ発生します。
<p>
このスキャンルールはテキストレスポンスのみを分析します。 
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/UsernameIdorScanRule.java">UsernameIdorScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10057/">10057</a>.

<h2 id="id-10032">VIEWSTATE</h2>
VIEWSTATE パラメータを識別し、以下のようなさまざまなベストプラクティスや保護措置について分析しようとします： 
<ul>
	<li>ASP.NET 1.0および1.1に基づくもの</li>
	<li>署名が欠如しているVIEWSTATE</li>
	<li>分割されたVIEWSTATE</li>
	<li>メールまたはIPパターンを含むVIEWSTATE</li>
</ul>
"MAC署名なしのViewstate (確信度: 低)" アラートは、LOWしきい値でのみ発生します。
<p>
最新のコード:  <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ViewstateScanRule.java">ViewstateScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10032/">10032</a>

<h2 id="id-10061">X-AspNet-Version レスポンスヘッダー</h2>
レスポンスヘッダーに X-AspNet-Version/X-AspNetMvc-Version の詳細が存在するかどうかをチェックします。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XAspNetVersionScanRule.java">XAspNetVersionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10061/">10061</a>

<h2 id="id-10039">X-Backend-Server ヘッダーによる情報漏洩</h2>
レスポンスヘッダーに X-Backend-Server の詳細が存在するかどうかをチェックします。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XBackendServerInformationLeak.java">XBackendServerInformationLeak.java</a><br>
アラートID:  <a href="https://www.zaproxy.org/docs/alerts/10039/">10039</a>

<h2 id="id-10052">X-ChromeLogger-Data (XCOLD) ヘッダーによる情報漏洩</h2>
レスポンスヘッダーに X-ChromeLogger-Data または X-ChromePhp-Data の詳細が存在するかどうかをチェックします。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XChromeLoggerDataInfoLeakScanRule.java">XChromeLoggerDataInfoLeakScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10052/">10052</a>

<h2 id="id-10021">X-Content-Type-Options</h2>
このスキャンルールは、Anti-MIME-Sniffing ヘッダーである X-Content-Type-Options をチェックし、'nosniff' に設定されていることを確認します。<br>
MEDIUMおよびHIGHしきい値では、このルールはクライアントまたはサーバーエラーレスポンスやリダイレクトではアラートを出しません。<br>
LOWしきい値では、エラーやリダイレクトを含むすべてのレスポンスでアラートを出します。<br>
<p>
最新コード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XContentTypeOptionsScanRule.java">XContentTypeOptionsScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10021/">10021</a>

<h2 id="id-10056">X-Debug-Token ヘッダーによる情報漏洩</h2>
レスポンスヘッダーに X-Debug-Token および X-Debug-Token-Link の詳細が存在するかどうかをチェックします。
これは、SymfonyのProfilerの使用/露出を示しています。 SymfonyのProfilerは悪意のある個人やセキュリティテスターにとって関心のある大量の情報へのアクセスを提供します。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XDebugTokenScanRule.java">XDebugTokenScanRule.java</a>
<br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10056/">10056</a>.

<h2 id="id-10116">古いZAPバージョン</h2>
このチェックは最新バージョンのZAPを使用していることを確認します。<br>
ZAPのインストールが古い場合、各ドメインで1つのアラートが発生し、深刻度はバージョンがどれだけ古いかに基づいて設定されます。<br>
<ul>
<li>1バージョン: 低リスク
<li>2バージョン: 中リスク
<li>3バージョン以上: 高リスク
<li>1年以上: 高リスク (nightly ビルドや weekly リリースなど、日付スタンプされたバージョンの場合のみ)
</ul>

<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/ZapVersionScanRule.java">ZapVersionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10116/">10116</a>.

</body>
</html>
