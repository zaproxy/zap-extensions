
CREATE CACHED TABLE ALERT (

    "CREATETIMESTAMP" TIMESTAMP NULL,
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PAYLOAD VARCHAR(512) NOT NULL,
    MESSAGEID BIGINT,

    ALERTID BIGINT,
    PLUGINID INTEGER DEFAULT 0,
    NAME VARCHAR(16777216) DEFAULT '',
    RISK INTEGER DEFAULT 0,
    CONFIDENCE INTEGER DEFAULT 1,
    DESCRIPTION VARCHAR(16777216) DEFAULT '',
    URI VARCHAR(1048576) DEFAULT '',
    PARAM VARCHAR(32768) DEFAULT '',
    OTHERINFO VARCHAR(16777216) DEFAULT '',
    SOLUTION VARCHAR(16777216) DEFAULT '',
    REFERENCE VARCHAR(16777216) DEFAULT '',
    ATTACK VARCHAR(32768) DEFAULT '',
    EVIDENCE VARCHAR(16777216) DEFAULT '',
    CWEID INTEGER DEFAULT -1,
    WASCID INTEGER DEFAULT -1,
    SOURCEID INTEGER DEFAULT 0,
    INPUTVECTOR VARCHAR(256) DEFAULT '',
    ALERTREF VARCHAR(256) DEFAULT ''

);

CREATE INDEX ALERT_PAYLOAD_IDX ON ALERT (PAYLOAD);

CREATE CACHED TABLE MESSAGE (

    "CREATETIMESTAMP" TIMESTAMP NULL,
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1),

    TIMESENTMILLIS BIGINT DEFAULT 0,
    TIMEELAPSEDMILLIS INTEGER DEFAULT 0,
    REQHEADER VARCHAR(4194304) DEFAULT '',
    REQBODY VARBINARY(16777216) DEFAULT X'',
    RESHEADER VARCHAR(4194304) DEFAULT '',
    RESBODY VARBINARY(16777216) DEFAULT X'',
    RESPONSEFROMTARGETHOST BOOLEAN DEFAULT FALSE

);
